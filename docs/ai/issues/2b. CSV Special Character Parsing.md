# Issue #2b: CSV Special Character Parsing

```typescript
// text-normalize.ts
export interface NormalizeOptions {
  /**
   * Convert typographic punctuation to ASCII-friendly forms.
   * (quotes → ' ", dashes → -, ellipsis → ... )
   */
  asciiPunctuation?: boolean; // default true
  /** Convert all dash-like characters to a simple hyphen-minus '-' */
  convertDashesToHyphen?: boolean; // default true
  /** Convert ellipsis (…) to "..." */
  convertEllipsis?: boolean; // default true
  /** Replace NBSP and other exotic spaces with a normal space ' ' */
  normalizeSpaces?: boolean; // default true
  /** Remove zero-width, BOM, and other invisible control chars */
  stripInvisible?: boolean; // default true
  /** Collapse consecutive spaces to a single space and trim ends */
  collapseWhitespace?: boolean; // default true
  /** Apply Unicode normalization (NFC) first */
  unicodeNormalize?: boolean; // default true
}

const DEFAULTS: Required<NormalizeOptions> = {
  asciiPunctuation: true,
  convertDashesToHyphen: true,
  convertEllipsis: true,
  normalizeSpaces: true,
  stripInvisible: true,
  collapseWhitespace: true,
  unicodeNormalize: true,
};

/**
 * Normalize "fancy" punctuation, spaces, and invisibles into clean, app-safe text.
 */
export function normalizeText(input: string, opts: NormalizeOptions = {}): string {
  const o = { ...DEFAULTS, ...opts };
  let s = input ?? "";

  if (o.unicodeNormalize) {
    try { s = s.normalize("NFC"); } catch { /* ignore if environment lacks Intl */ }
  }

  if (o.stripInvisible) {
    // Zero width & BOM & general format controls
    // ZWSP, ZWNJ, ZWJ, ZWNBSP, BOM, soft hyphen, etc.
    s = s.replace(/[\u200B-\u200D\u2060\uFEFF\u00AD]/g, "");
  }

  if (o.normalizeSpaces) {
    // Replace non-breaking & exotic spaces with a normal space
    // NBSP, narrow no-break, thin space, en space, em space, figure, punctuation, ideographic, etc.
    s = s.replace(
      /[\u00A0\u2000-\u200A\u202F\u205F\u3000]/g,
      " "
    );
  }

  if (o.asciiPunctuation) {
    // Smart quotes/apostrophes → straight
    s = s
      // Double quotes
      .replace(/[\u201C\u201D\u201E\u201F\u2033\u2036]/g, '"')
      // Single quotes / apostrophes
      .replace(/[\u2018\u2019\u201A\u201B\u2032\u2035]/g, "'");

    // Dashes and hyphens
    if (o.convertDashesToHyphen) {
      // hyphen, non-breaking hyphen, figure dash, en dash, em dash, minus sign
      s = s.replace(/[\u2010\u2011\u2012\u2013\u2014\u2212]/g, "-");
    }

    // Ellipsis
    if (o.convertEllipsis) {
      s = s.replace(/\u2026/g, "...");
    }

    // Misc punctuation often found in pasted text
    // “bullets” -> "-"
    s = s.replace(/[•‣◦]/g, "-");
    // “prime” inches/feet symbols: leave as-is by default
    // If you want to normalize ″/′ too, uncomment:
    // s = s.replace(/[\u2032]/g, "'").replace(/[\u2033]/g, '"');
  }

  if (o.collapseWhitespace) {
    // Collapse multiple spaces; normalize line endings; trim
    s = s
      .replace(/\r\n?/g, "\n")         // CRLF / CR → LF
      .replace(/[ \t]+\n/g, "\n")      // trailing spaces before newline
      .replace(/\n{3,}/g, "\n\n")      // max two consecutive blank lines
      .replace(/[ \t]{2,}/g, " ")      // collapse runs of spaces/tabs
      .trim();
  }

  return s;
}
```