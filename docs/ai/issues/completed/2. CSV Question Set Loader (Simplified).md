# Issue #2: CSV Clue Set Loader (Simplified)

**Status**: ðŸ”„ IN PROGRESS
**Priority**: ðŸ”´ High (Foundation)
**Epic**: Content Management
**Estimated Time**: 45 minutes

## Overview

Implement a simplified CSV clue set loader that can read clue sets from `public/clue-sets/` and populate the database. Focus on getting clue sets loaded quickly to enable game development - skip complex validation and error handling for now.

## Goals

- **Primary**: Load CSV clue sets into database for game testing
- **Secondary**: Enable hosts to select from available clue sets
- **Tertiary**: Set up foundation for future clue set management

## Super Simple Implementation Plan

### Step 1: CSV Parser Utility (15 minutes)

**1.1 Create CSV Parser**
```typescript
// src/utils/csvParser.ts
interface CSVRow {
  round: 'jeopardy' | 'double' | 'final'
  category: string
  value: number
  prompt: string
  response: string
}

// Parse CSV text into structured data
// Handle quoted fields with commas
// Convert string values to numbers
```

**1.2 File Name Parser**
```typescript
// src/utils/questionSetUtils.ts
// "test-game-1.csv" â†’ "Test Game 1"
// Handle hyphens, underscores, title case conversion
```

### Step 2: Question Set Loader Service (20 minutes)

**2.1 Create Loader Service**
```typescript
// src/services/clueSets/loader.ts
interface QuestionSetData {
  name: string
  filename: string
  rounds: {
    first: CategoryData[]
    second: CategoryData[]
    final: CategoryData
  }
}

// Fetch CSV from public/clue-sets/
// Parse CSV data
// Structure into rounds and categories
// Validate basic structure (30 first + 30 second + 1 final)
```

**2.2 Database Integration**
```typescript
// Save to Supabase tables:
// - clue_sets (name, created_by)
// - boards (clue_set_id, round_type)
// - categories (board_id, name, position)
// - clues (category_id, value, prompt, response, position)
```

### Step 3: Simple UI Component (10 minutes)

**3.1 Question Set Selector**
```typescript
// src/components/clueSets/ClueSetSelector.tsx
- Dropdown/list of available CSV files
- Load button to import selected set
- Show loading state during import
- Display success/error messages
- No validation, no complex error handling
```

**3.2 Integration**
```typescript
// Add to main app or create simple admin page
// Show current user's clue sets
// Allow loading new sets from CSV files
```

## File Structure (Minimal)

```
src/
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ csvParser.ts              (40 lines)
â”‚   â””â”€â”€ questionSetUtils.ts       (20 lines)
â”œâ”€â”€ services/
â”‚   â””â”€â”€ clueSets/
â”‚       â””â”€â”€ loader.ts             (80 lines)
â””â”€â”€ components/
    â””â”€â”€ clueSets/
        â””â”€â”€ ClueSetSelector.tsx (60 lines)
```

## Success Criteria

- [ ] Can load test-game-1.csv from public/clue-sets/
- [ ] CSV data is parsed correctly (62 rows â†’ structured data)
- [ ] Question set is saved to database with proper relationships
- [ ] File name is converted to display name ("Test Game 1")
- [ ] Basic UI allows selecting and loading clue sets
- [ ] Ready to use clue sets for game creation

## Implementation Details

### CSV Structure Expected
```csv
round,category,value,prompt,response
jeopardy,World Capitals,200,World Capitals 1,What is World Capitals 1
double,Science & Nature,400,Science & Nature 1,What is Science & Nature 1
final,Going West,0,Going West 1,What is Going West 1
```

### Database Flow
1. **Create clue_set** record with parsed name
2. **Create boards** for FIRST, SECOND, FINAL rounds
3. **Create categories** for each unique category per round
4. **Create clues** for each category with proper relationships

### File Discovery
```typescript
// For now, hardcode available files or use simple fetch
const availableFiles = [
  'test-game-1.csv',
  // Add more as needed
]

// Future: Could scan directory or use file input
```

## What We're Skipping (For Now)

- CSV validation and error handling
- File upload interface (using existing files)
- Duplicate clue set detection
- Question set editing/management
- Advanced parsing (images, media, special formatting)
- Daily Double marking (will be handled by game logic)
- Category/clue ordering validation
- User permissions for clue set creation

## Next Steps After Completion

1. **Test with test-game-1.csv** to verify all data loads correctly
2. **Verify database relationships** are properly created
3. **Check clue set appears** in any existing UI
4. **Proceed to Issue #3** (Game Host Dashboard) to use loaded clue sets

## Future Enhancement Phases

### Phase 3 Near-Future (When Game Works)
- File upload interface for custom CSV files
- Basic CSV validation and error reporting
- Question set management (list, delete, rename)
- Duplicate detection and handling

### Phase 3 Public Release (Much Later)
- Advanced CSV validation with detailed error messages
- Question set sharing between users
- Import from external sources (J-Archive, etc.)
- Rich text formatting and media support
- Question set templates and wizards

---

*This bare-minimum approach gets clue sets loaded in 45 minutes so we can focus on building the actual game mechanics!*
